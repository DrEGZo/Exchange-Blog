<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyDFm0hNUOwU1TjpA8eV5dosr1-D1SX1PbM",
        authDomain: "exchange-blog.firebaseapp.com",
        databaseURL: "https://exchange-blog.firebaseio.com",
        projectId: "exchange-blog",
        storageBucket: "exchange-blog.appspot.com",
        messagingSenderId: "977760272277"
      };
      firebase.initializeApp(config);

      function login() {
        $.ajax({
          method: 'POST',
          url: '/login',
          data: {"email": "squamato77@gmail.com", "pass": "abcde"},
          success: (data) => {
            firebase.auth().signInWithCustomToken(data);
          }
        });
      }
      function logout() {
        firebase.auth().signOut();
      }
      function state () {
        var user = firebase.auth().currentUser;
        if (user) {
          console.log('User is signed in');
        } else {
          console.log('No user is signed in');
        }
      }

      function auth () {
        firebase.auth().signInWithEmailAndPassword('squamato77@gmail.com','abcdefg')
        .catch(error => {
          console.log('Error occured:', error);
        })
        .then(() => {
          firebase.auth().currentUser.getIdToken(true)
          .then(function(idToken) {
            $.ajax({
              method: 'POST',
              url: '/auth',
              data: {"idToken": idToken},
              success: (data) => {
                console.log(data);
              }
            });
          });
        });
      }
    </script>
  </head>
  <body>
    <button type="button" onclick="auth()">Auth</button>
    <button type="button" onclick="logout()">Logout</button>
    <button type="button" onclick="state()">State</button>
  </body>
</html>
